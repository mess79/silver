#!/bin/bash
echo "Custom scripts before assembling:"
echo ""

set -e

source /usr/libexec/s2i/env

yum install gcc

echo ""

/usr/libexec/s2i/assemble
rc=$?

if [ $rc -eq 0 ]; then
    echo "Custom successful assembling"
else
    echo "custom failed assembling"
fi

echo "---> Cleaning up npm cache"
rm -rf .npm

echo "---> Fix permissions on app-root"
fix-permissions /opt/app-root

exit $rc
